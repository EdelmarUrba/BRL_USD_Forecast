---
autoinstall:
  version: 1

  identity:
    hostname: ubuntu-dualboot
    username: urbauser
    password: "$6$SALTSALT$hashaqui"
  locale: pt_BR.UTF-8
  keyboard:
    layout: br
    variant: abnt2
  timezone: America/Sao_Paulo

  ssh:
    install-server: true
    allow-pw: false
    authorized-keys: []

  storage:
    layout:
      name: custom
    swap:
      size: 32G
    devices:
      - match:
          serial: "SFYRDK2000G"
        ptable: gpt
        wipe: superblock-recursive
        preserve: false
        grub_device: true
        partitions:
          - size: 512M
            id: efi-part
            type: EF00
            fs:
              type: fat32
            label: EFI
            flag: boot, esp
            mount: /boot/efi
          - size: 150G
            id: ubuntu-root
            type: 8300
            flag: linux-root
            fs:
              type: ext4
            label: UbuntuRoot
            mount: /
          - size: 150G
            id: ubuntu-home
            type: 8300
            fs:
              type: ext4
            label: Home
            mount: /home
          - size: 32G
            id: swap-part
            type: 8200
            flag: swap
          - size: 350G
            id: shared-ntfs
            type: 0700
            fs:
              type: ntfs
            label: Compartilhada
            mount: /mnt/compartilhada
          - size: 900G
            id: win-space
            type: 0700
            preserve: false
          - size: 116G
            id: reserved-space
            type: 8300
            fs:
              type: ext4
            label: Reservada
            preserve: true

  apt:
    primary:
      - http://archive.ubuntu.com/ubuntu
    security:
      - http://security.ubuntu.com/ubuntu

  packages:
    - build-essential
    - python3
    - python3-pip
    - python3-venv
    - git
    - unzip
    - curl
    - wget
    - htop
    - ntfs-3g
    - software-properties-common

  late-commands:
    - curtin in-target -- bash -c "echo '[INFO] Iniciando auto-instalação...';"
    - curtin in-target -- bash -c "apt update && apt upgrade -y"
    - curtin in-target -- bash -c "snap install snapcraft --classic"
    - curtin in-target -- bash -c "echo '[INFO] Instalação do Ubuntu finalizada com sucesso.'"

  interactive-sections:
    - storage
    - user
    - network
    - ssh
